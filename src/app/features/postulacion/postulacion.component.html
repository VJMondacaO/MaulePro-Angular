<!-- Página de Postulación de Proyecto -->
<div class="min-h-screen bg-surface-100 dark:bg-surface-950 py-8 lg:py-12">
  <div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-7xl">
    <!-- Botón Volver -->
    <div class="mb-6">
      <button 
        pButton 
        type="button"
        label="Volver" 
        icon="pi pi-chevron-left"
        iconPos="left"
        class="rounded-full p-button-outlined p-button-secondary"
        [routerLink]="['/home']">
      </button>
    </div>
    
    <!-- Hero Section -->
    <section class="bg-gradient-to-br from-[#003B8D] to-[#0066CC] text-white rounded-lg shadow-lg mb-8 lg:mb-12 p-6 lg:p-12">
      <h1 class="text-3xl lg:text-4xl xl:text-5xl font-bold mb-4 leading-tight">
        POSTULACIÓN DE PROYECTO
      </h1>
    </section>

    <!-- Formulario de Postulación -->
    <div class="contenido-principal">
      <form [formGroup]="postulacionForm" (ngSubmit)="onSubmit()">
        
        <!-- Barra de Progreso -->
        <div id="progreso-postulacion" class="mb-8 lg:mb-12">
          <!-- Contenedor Principal de la Barra de Progreso -->
          <div class="bg-white rounded-lg shadow-md border border-gray-200 p-5 lg:p-6">
            <!-- Información del Progreso -->
            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-5">
              <div>
                <h3 class="text-base lg:text-lg font-bold text-gray-800">Progreso de Postulación</h3>
                <p class="text-xs lg:text-sm text-gray-600 mt-1">Paso {{ currentStep + 1 }} de {{ steps.length }}</p>
              </div>
              <div class="text-left sm:text-right">
                <div class="text-xl lg:text-2xl font-bold text-blue-600">{{ getProgressPercentage() }}%</div>
                <div class="text-xs text-gray-500">Completado</div>
              </div>
            </div>

            <!-- Barra de Progreso Visual -->
            <div class="relative w-full h-3 lg:h-4 bg-gray-200 rounded-full overflow-hidden mb-6 lg:mb-8">
              <div 
                class="absolute top-0 left-0 h-full bg-gradient-to-r from-blue-600 to-blue-500 rounded-full transition-all duration-500 ease-out shadow-sm"
                [style.width.%]="getProgressPercentage()">
                <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent animate-shimmer"></div>
              </div>
            </div>

            <!-- Pasos del Formulario -->
            <div class="relative pt-2">
              <!-- Línea de Conexión -->
              <div class="absolute left-0 top-6 w-full h-1 bg-gray-200 -z-10"></div>
              <div 
                class="absolute left-0 top-6 h-1 bg-gradient-to-r from-blue-600 to-blue-500 -z-10 transition-all duration-500 ease-out"
                [style.width.%]="getConnectionLinePercentage()">
              </div>

              <!-- Pasos -->
              <div class="grid grid-cols-6 gap-0 relative">
                @for (step of steps; track $index) {
                  <div 
                    class="flex flex-col items-center cursor-pointer group transition-all duration-300"
                    (click)="goToStep($index)">
                    <!-- Círculo del Paso -->
                    <div 
                      class="relative w-12 h-12 lg:w-14 lg:h-14 rounded-full flex items-center justify-center font-bold text-base lg:text-lg transition-all duration-300 border-3 shadow-md z-10"
                      [ngClass]="{
                        'bg-gradient-to-br from-blue-600 to-blue-500 border-blue-600 text-white scale-110': currentStep >= $index,
                        'bg-white border-gray-300 text-gray-400': currentStep < $index,
                        'ring-4 ring-blue-200 shadow-lg': currentStep === $index,
                        'hover:scale-105': currentStep !== $index
                      }">
                      @if (currentStep > $index) {
                        <i class="pi pi-check text-base lg:text-lg"></i>
                      } @else {
                        <i [class]="step.icon" [class.text-base]="true" [class.lg:text-lg]="true"></i>
                      }
                    </div>
                    
                    <!-- Etiqueta del Paso -->
                    <div class="mt-4 lg:mt-5 text-center w-full px-1">
                      <span 
                        class="text-xs lg:text-sm font-semibold block leading-tight transition-colors duration-300"
                        [ngClass]="{
                          'text-blue-600': currentStep >= $index, 
                          'text-gray-500': currentStep < $index
                        }">
                        {{ step.label }}
                      </span>
                      @if (currentStep === $index) {
                        <span class="text-xs text-blue-500 font-medium mt-1.5 block">Actual</span>
                      }
                    </div>
                  </div>
                }
              </div>
            </div>
          </div>
        </div>

        <!-- Steps Container -->
        <div class="space-y-6">
          
          @if (currentStep === 0) {
          <!-- Sección 0: Información Básica -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <div class="w-full px-6 py-4 bg-gray-50 border-b border-gray-200">
              <h3 class="text-lg font-semibold">Información Básica</h3>
            </div>
            <div>
              <div class="p-6 space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                  <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Cód. Proyecto</label>
                    <input 
                      type="text"
                      formControlName="cod1"
                      placeholder="Ingrese Cod. Proyecto"
                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
                  </div>
                  <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Proceso Presupuestario <span class="text-red-600">*</span></label>
                    <p-dropdown 
                      formControlName="proceso_presupuestario"
                      [options]="procesoPresupuestarioOptions"
                      optionLabel="label"
                      optionValue="value"
                      placeholder="Seleccione"
                      appendTo="body"
                      class="w-full">
                    </p-dropdown>
                    <small class="text-red-600 text-xs" *ngIf="postulacionForm.get('proceso_presupuestario')?.invalid && postulacionForm.get('proceso_presupuestario')?.touched">
                      Este campo es requerido
                    </small>
                  </div>
                  <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Correo electrónico Formulador <span class="text-red-600">*</span></label>
                    <input 
                      type="email"
                      formControlName="email"
                      placeholder="Ingrese Correo electrónico"
                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
                    <small class="text-red-600 text-xs" *ngIf="postulacionForm.get('email')?.invalid && postulacionForm.get('email')?.touched">
                      <span *ngIf="postulacionForm.get('email')?.errors?.['required']">Este campo es requerido</span>
                      <span *ngIf="postulacionForm.get('email')?.errors?.['email']">Email inválido</span>
                    </small>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 1: Nombre de la Iniciativa -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <div class="w-full px-6 py-4 bg-gray-50 border-b border-gray-200">
              <h3 class="text-lg font-semibold">NOMBRE DE LA INICIATIVA</h3>
            </div>
            <div>
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <input 
                    type="text"
                    formControlName="item_nombre"
                    placeholder="Ingrese Nombre de la Iniciativa"
                    class="w-full px-4 py-3 text-lg border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
                  <small class="text-red-600 text-xs mt-1 block" *ngIf="postulacionForm.get('item_nombre')?.invalid && postulacionForm.get('item_nombre')?.touched">
                    Este campo es requerido
                  </small>
                  
                  <div class="mt-6">
                    <label class="block text-sm font-semibold text-gray-700 mb-2">DESCRIPTOR</label>
                    <input 
                      type="text"
                      formControlName="item_descriptor"
                      placeholder="Ingrese DESCRIPTOR"
                      readonly
                      class="w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed">
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 2: Sector/Subsector -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <div class="w-full px-6 py-4 bg-gray-50 border-b border-gray-200">
              <h3 class="text-lg font-semibold">SECTOR/SUBSECTOR</h3>
            </div>
            <div>
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                      <label class="block text-sm font-semibold text-gray-700 mb-2">Sector <span class="text-red-600">*</span></label>
                      <input 
                        type="text"
                        formControlName="item_sector"
                        placeholder="INGRESE SECTOR"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
                      <small class="text-red-600 text-xs mt-1 block" *ngIf="postulacionForm.get('item_sector')?.invalid && postulacionForm.get('item_sector')?.touched">
                        Este campo es requerido
                      </small>
                    </div>
                    <div>
                      <label class="block text-sm font-semibold text-gray-700 mb-2">Subsector <span class="text-red-600">*</span></label>
                      <input 
                        type="text"
                        formControlName="item_subsector"
                        placeholder="INGRESE SUBSECTOR"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
                      <small class="text-red-600 text-xs mt-1 block" *ngIf="postulacionForm.get('item_subsector')?.invalid && postulacionForm.get('item_subsector')?.touched">
                        Este campo es requerido
                      </small>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 3: Localización Geográfica -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <div class="w-full px-6 py-4 bg-gray-50 border-b border-gray-200">
              <h3 class="text-lg font-semibold">LOCALIZACIÓN GEOGRÁFICA</h3>
            </div>
            <div>
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                      <label class="block text-sm font-semibold text-gray-700 mb-2">Provincia <span class="text-red-600">*</span></label>
                      <p-dropdown 
                        formControlName="item_provincia"
                        [options]="provinciaOptions"
                        optionLabel="label"
                        optionValue="value"
                        placeholder="Seleccione Provincia"
                        appendTo="body"
                        class="w-full">
                      </p-dropdown>
                      <small class="text-red-600 text-xs mt-1 block" *ngIf="postulacionForm.get('item_provincia')?.invalid && postulacionForm.get('item_provincia')?.touched">
                        Este campo es requerido
                      </small>
                    </div>
                    <div>
                      <label class="block text-sm font-semibold text-gray-700 mb-2">Comuna <span class="text-red-600">*</span></label>
                      <p-dropdown 
                        formControlName="item_comuna"
                        [options]="comunaOptions"
                        optionLabel="label"
                        optionValue="value"
                        placeholder="Seleccione Comuna"
                        appendTo="body"
                        class="w-full">
                      </p-dropdown>
                      <small class="text-red-600 text-xs mt-1 block" *ngIf="postulacionForm.get('item_comuna')?.invalid && postulacionForm.get('item_comuna')?.touched">
                        Este campo es requerido
                      </small>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          }

          @if (currentStep === 0) {
          <!-- Sección 5: Distrito y Circunscripción -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <div class="w-full px-6 py-4 bg-gray-50 border-b border-gray-200">
              <h3 class="text-lg font-semibold">DISTRITO Y CIRCUNSCRIPCIÓN</h3>
            </div>
            <div>
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                      <label class="block text-sm font-semibold text-gray-700 mb-2">DISTRITO</label>
                      <input 
                        type="text"
                        formControlName="item_distrito"
                        placeholder="INGRESE DISTRITO"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
                    </div>
                    <div>
                      <label class="block text-sm font-semibold text-gray-700 mb-2">CIRCUNSCRIPCIÓN</label>
                      <input 
                        type="text"
                        formControlName="item_circunscripcion"
                        placeholder="INGRESE CIRCUNSCRIPCIÓN"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 4: Competencia de Análisis -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <div class="w-full px-6 py-4 bg-gray-50 border-b border-gray-200">
              <h3 class="text-lg font-semibold">COMPETENCIA DE ANÁLISIS</h3>
            </div>
            <div>
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <label class="block text-sm font-semibold text-gray-700 mb-2">Competencia de Análisis <span class="text-red-600">*</span></label>
                  <p-dropdown 
                    formControlName="item_competencia"
                    [options]="competenciaOptions"
                    optionLabel="label"
                    optionValue="value"
                    placeholder="SELECCIONAR COMP. DE ANÁLISIS"
                    appendTo="body"
                    class="w-full">
                  </p-dropdown>
                  <small class="text-red-600 text-xs mt-1 block" *ngIf="postulacionForm.get('item_competencia')?.invalid && postulacionForm.get('item_competencia')?.touched">
                    Este campo es requerido
                  </small>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 6: Proyecto Relacionado y SEIA -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <div class="w-full px-6 py-4 bg-gray-50 border-b border-gray-200">
              <h3 class="text-lg font-semibold">PROYECTO RELACIONADO Y SEIA</h3>
            </div>
            <div>
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                      <label class="block text-sm font-semibold text-gray-700 mb-2">PROYECTO RELAC.</label>
                      <p-dropdown 
                        formControlName="item_proyectorel"
                        [options]="proyectoRelOptions"
                        optionLabel="label"
                        optionValue="value"
                        placeholder="SELECCIONAR"
                        appendTo="body"
                        class="w-full">
                      </p-dropdown>
                    </div>
                    <div>
                      <label class="block text-sm font-semibold text-gray-700 mb-2">SEIA</label>
                      <p-dropdown 
                        formControlName="item_seia"
                        [options]="seiaOptions"
                        optionLabel="label"
                        optionValue="value"
                        placeholder="NO CORRESPONDE"
                        appendTo="body"
                        class="w-full">
                      </p-dropdown>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Step 0 Navigation (End of Step 0) -->
          <div class="flex justify-end pt-6">
            <button 
              type="button"
              (click)="nextStep()"
              class="px-8 py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg shadow-lg transition-all duration-300 flex items-center gap-2 transform hover:scale-105">
              <span>Siguiente Paso</span>
              <i class="pi pi-arrow-right"></i>
            </button>
          </div>
          }

          @if (currentStep === 1) {
          <!-- Sección 7: Justificación del Proyecto -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <div class="w-full px-6 py-4 bg-gray-50 border-b border-gray-200">
              <h3 class="text-lg font-semibold">JUSTIFICACIÓN DEL PROYECTO</h3>
            </div>
            <div>
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <label class="block text-sm font-semibold text-gray-700 mb-2">JUSTIFICACIÓN</label>
                  <textarea 
                    formControlName="justificacion_proyecto"
                    rows="5"
                    placeholder="INGRESE JUSTIFICACIÓN"
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all resize-none"></textarea>
                  <small class="text-red-600 text-xs mt-1 block" *ngIf="postulacionForm.get('justificacion_proyecto')?.invalid && postulacionForm.get('justificacion_proyecto')?.touched">
                    Este campo es requerido
                  </small>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 8: Descripción del Proyecto -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <div class="w-full px-6 py-4 bg-gray-50 border-b border-gray-200">
              <h3 class="text-lg font-semibold">DESCRIPCIÓN DEL PROYECTO</h3>
            </div>
            <div>
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <label class="block text-sm font-semibold text-gray-700 mb-2">DESCRIPCIÓN</label>
                  <textarea 
                    formControlName="descripcion_proyecto"
                    rows="5"
                    placeholder="INGRESE DESCRIPCIÓN"
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all resize-none"></textarea>
                  <small class="text-red-600 text-xs mt-1 block" *ngIf="postulacionForm.get('descripcion_proyecto')?.invalid && postulacionForm.get('descripcion_proyecto')?.touched">
                    Este campo es requerido
                  </small>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 9: Objetivos -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <div class="w-full px-6 py-4 bg-gray-50 border-b border-gray-200">
              <h3 class="text-lg font-semibold">OBJETIVOS</h3>
            </div>
            <div>
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <div class="grid grid-cols-1 gap-6">
                    <div>
                      <label class="block text-sm font-semibold text-gray-700 mb-2">OBJETIVO GENERAL</label>
                      <textarea 
                        formControlName="item_obj_general"
                        rows="3"
                        placeholder="INGRESE OBJETIVO GENERAL"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all resize-none"></textarea>
                    </div>
                    <div>
                      <label class="block text-sm font-semibold text-gray-700 mb-2">OBJETIVO ESPECÍFICO</label>
                      <textarea 
                        formControlName="item_obj_especifico"
                        rows="3"
                        placeholder="INGRESE OBJETIVO ESPECÍFICO"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all resize-none"></textarea>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 10: Desarrollo Indígena -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <div class="w-full px-6 py-4 bg-gray-50 border-b border-gray-200">
              <h3 class="text-lg font-semibold">DESARROLLO INDÍGENA</h3>
            </div>
            <div>
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <label class="block text-sm font-semibold text-gray-700 mb-2">DESARROLLO INDÍGENA</label>
                  <p-dropdown 
                    formControlName="item_des_indigena"
                    [options]="desIndigenaOptions"
                    optionLabel="label"
                    optionValue="value"
                    placeholder="NO APLICA"
                    appendTo="body"
                    class="w-full">
                  </p-dropdown>
                </div>
              </div>
            </div>
          </div>

          <!-- Step 1 Navigation (End of Step 1) -->
          <div class="flex justify-between pt-6">
            <button 
              type="button"
              (click)="prevStep()"
              class="px-8 py-3 bg-gray-600 hover:bg-gray-700 text-white font-bold rounded-lg shadow-lg transition-all duration-300 flex items-center gap-2 transform hover:scale-105">
              <i class="pi pi-arrow-left"></i>
              <span>Anterior</span>
            </button>
            <button 
              type="button"
              (click)="nextStep()"
              class="px-8 py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg shadow-lg transition-all duration-300 flex items-center gap-2 transform hover:scale-105">
              <span>Siguiente Paso</span>
              <i class="pi pi-arrow-right"></i>
            </button>
          </div>
          }

          @if (currentStep === 2) {
          <!-- Sección 11: Monto solicitado para financiamiento -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <div class="w-full px-6 py-4 bg-gray-50 border-b border-gray-200">
              <h3 class="text-lg font-semibold">MONTO SOLICITADO PARA FINANCIAMIENTO</h3>
            </div>
            <div>
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <label class="block text-sm font-semibold text-gray-700 mb-2">MONTO SOLICITADO</label>
                  <input 
                    type="number"
                    formControlName="presup1"
                    placeholder="INGRESE MONTO"
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
                  <small class="text-red-600 text-xs mt-1 block" *ngIf="postulacionForm.get('presup1')?.invalid && postulacionForm.get('presup1')?.touched">
                    Este campo es requerido
                  </small>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 12: Desglose del Presupuesto -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <div class="w-full px-6 py-4 bg-gray-50 border-b border-gray-200">
              <h3 class="text-lg font-semibold">DESGLOSE DEL PRESUPUESTO</h3>
            </div>
            <div>
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <p class="text-gray-600 mb-4">Ingrese el detalle de los ítems presupuestarios.</p>
                  <div class="text-center p-8 border-2 border-dashed border-gray-300 rounded-lg">
                    <p class="text-gray-500">Funcionalidad de desglose en desarrollo</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 13: Aportes de Terceros -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <div class="w-full px-6 py-4 bg-gray-50 border-b border-gray-200">
              <h3 class="text-lg font-semibold">APORTES DE TERCEROS</h3>
            </div>
            <div>
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <label class="block text-sm font-semibold text-gray-700 mb-2">APORTES DE TERCEROS</label>
                  <p-dropdown 
                    formControlName="item_aportes"
                    [options]="[{label: 'SI', value: 'SI'}, {label: 'NO', value: 'NO'}]"
                    placeholder="SELECCIONE"
                    appendTo="body"
                    class="w-full">
                  </p-dropdown>
                </div>
              </div>
            </div>
          </div>

          <!-- Step 3 Navigation (End of Step 3) -->
          <div class="flex justify-between pt-6">
            <button 
              type="button"
              (click)="prevStep()"
              class="px-8 py-3 bg-gray-600 hover:bg-gray-700 text-white font-bold rounded-lg shadow-lg transition-all duration-300 flex items-center gap-2 transform hover:scale-105">
              <i class="pi pi-arrow-left"></i>
              <span>Anterior</span>
            </button>
            <button 
              type="button"
              (click)="nextStep()"
              class="px-8 py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg shadow-lg transition-all duration-300 flex items-center gap-2 transform hover:scale-105">
              <span>Siguiente Paso</span>
              <i class="pi pi-arrow-right"></i>
            </button>
          </div>
          }

          @if (currentStep === 3) {
          <!-- Sección 14: Resumen de los Resultados del Proyecto -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <div class="w-full px-6 py-4 bg-gray-50 border-b border-gray-200">
              <h3 class="text-lg font-semibold">RESUMEN DE LOS RESULTADOS DEL PROYECTO</h3>
            </div>
            <div>
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <!-- Duración -->
                  <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                    <div class="bg-blue-200 p-3 rounded-lg">
                      <label class="block text-sm font-semibold text-gray-800">Duración</label>
                    </div>
                    <div class="md:col-span-2 flex items-center gap-4">
                      <p-inputNumber 
                        formControlName="duracion_proyecto"
                        mode="decimal"
                        [min]="0"
                        class="w-32">
                      </p-inputNumber>
                      <span class="text-sm font-semibold text-gray-700">Meses</span>
                    </div>
                  </div>

                  <!-- Beneficiarios Directos -->
                  <div class="mb-4">
                    <div class="bg-blue-200 p-3 rounded-lg mb-2">
                      <label class="block text-sm font-semibold text-gray-800">Beneficiarios Directos</label>
                    </div>
                    <div class="space-y-2">
                      <div class="flex items-center gap-4">
                        <label class="text-sm font-semibold text-gray-700 w-32">Hombres:</label>
                        <p-inputNumber 
                          formControlName="benef_hombres"
                          mode="decimal"
                          [min]="0"
                          class="flex-1">
                        </p-inputNumber>
                      </div>
                      <div class="flex items-center gap-4">
                        <label class="text-sm font-semibold text-gray-700 w-32">Mujeres:</label>
                        <p-inputNumber 
                          formControlName="benef_mujeres"
                          mode="decimal"
                          [min]="0"
                          class="flex-1">
                        </p-inputNumber>
                      </div>
                      <div class="flex items-center gap-4">
                        <label class="text-sm font-semibold text-gray-700 w-32">Total:</label>
                        <p-inputNumber 
                          formControlName="benef_total"
                          mode="decimal"
                          [min]="0"
                          class="flex-1"
                          [readonly]="true">
                        </p-inputNumber>
                      </div>
                    </div>
                  </div>

                  <!-- Magnitud del Proyecto -->
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                      <label class="block text-sm font-semibold text-gray-700 mb-2">MAGNITUD</label>
                      <input 
                        type="text"
                        formControlName="item_magnitud_valor"
                        placeholder="Ingrese MAGNITUD"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
                    </div>
                    <div>
                      <label class="block text-sm font-semibold text-gray-700 mb-2">UNIDAD MEDIDA</label>
                      <p-dropdown 
                        formControlName="item_magnitud"
                        [options]="magnitudOptions"
                        optionLabel="label"
                        optionValue="value"
                        placeholder="Definir Unidad Medida"
                        [filter]="shouldFilterMagnitud"
                        filterPlaceholder="Buscar..."
                        appendTo="body"
                        class="w-full">
                      </p-dropdown>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 15: Información de Contacto -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <div class="w-full px-6 py-4 bg-gray-50 border-b border-gray-200">
              <h3 class="text-lg font-semibold">INFORMACIÓN DE CONTACTO</h3>
            </div>
            <div>
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                      <label class="block text-sm font-semibold text-gray-700 mb-2">Nombre Contacto</label>
                      <input 
                        type="text"
                        formControlName="nombre_responsable"
                        placeholder="Ingrese Nombre"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
                    </div>
                    <div>
                      <label class="block text-sm font-semibold text-gray-700 mb-2">Teléfono Contacto</label>
                      <input 
                        type="text"
                        formControlName="responsable_fono"
                        placeholder="Ingrese Teléfono"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Step 3 Navigation (End of Step 3) -->
          <div class="flex justify-between pt-6">
            <button 
              type="button"
              (click)="prevStep()"
              class="px-8 py-3 bg-gray-600 hover:bg-gray-700 text-white font-bold rounded-lg shadow-lg transition-all duration-300 flex items-center gap-2 transform hover:scale-105">
              <i class="pi pi-arrow-left"></i>
              <span>Anterior</span>
            </button>
            <button 
              type="button"
              (click)="nextStep()"
              class="px-8 py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg shadow-lg transition-all duration-300 flex items-center gap-2 transform hover:scale-105">
              <span>Siguiente Paso</span>
              <i class="pi pi-arrow-right"></i>
            </button>
          </div>
          }



          @if (currentStep === 4) {
          <!-- Sección 16: Documentos Adjuntos -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <div class="w-full px-6 py-4 bg-gray-50 border-b border-gray-200">
              <h3 class="text-lg font-semibold">DOCUMENTOS ADJUNTOS</h3>
            </div>
            <div>
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <p class="text-gray-600 mb-4">Adjunte los documentos requeridos para la postulación.</p>
                  <!-- Aquí iría el componente de carga de archivos -->
                  <div class="text-center p-8 border-2 border-dashed border-gray-300 rounded-lg">
                    <i class="pi pi-cloud-upload text-4xl text-gray-400 mb-2"></i>
                    <p class="text-gray-500">Funcionalidad de carga de documentos en desarrollo</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Step 4 Navigation (End of Step 4) -->
          <div class="flex justify-between pt-6">
            <button 
              type="button"
              (click)="prevStep()"
              class="px-8 py-3 bg-gray-600 hover:bg-gray-700 text-white font-bold rounded-lg shadow-lg transition-all duration-300 flex items-center gap-2 transform hover:scale-105">
              <i class="pi pi-arrow-left"></i>
              <span>Anterior</span>
            </button>
            <button 
              type="button"
              (click)="nextStep()"
              class="px-8 py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg shadow-lg transition-all duration-300 flex items-center gap-2 transform hover:scale-105">
              <span>Siguiente Paso</span>
              <i class="pi pi-arrow-right"></i>
            </button>
          </div>
          }

          @if (currentStep === 5) {
          <!-- Mensaje de Revisión -->
          <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-6 rounded-r-lg shadow-sm">
            <div class="flex items-center">
              <div class="flex-shrink-0">
                <i class="pi pi-info-circle text-blue-500 text-xl"></i>
              </div>
              <div class="ml-3">
                <p class="text-sm text-blue-700 font-medium">
                  Por favor, revise toda la información subida en los pasos anteriores antes de finalizar su postulación.
                </p>
              </div>
            </div>
          </div>

          <!-- Sección 17: Declaración Jurada -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <div class="w-full px-6 py-4 bg-gray-50 border-b border-gray-200">
              <h3 class="text-lg font-semibold">DECLARACIÓN JURADA</h3>
            </div>
            <div>
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <div class="flex items-start gap-3">
                    <p-checkbox 
                      formControlName="declaracion_jurada" 
                      [binary]="true" 
                      inputId="declaracion">
                    </p-checkbox>
                    <label for="declaracion" class="text-sm text-gray-700 cursor-pointer">
                      Declaro bajo juramento que la información presentada en esta postulación es verídica y que cuento con las facultades para representar a la organización postulante.
                    </label>
                  </div>
                  <small class="text-red-600 text-xs mt-2 block" *ngIf="postulacionForm.get('declaracion_jurada')?.invalid && postulacionForm.get('declaracion_jurada')?.touched">
                    Debe aceptar la declaración jurada para continuar
                  </small>
                </div>
              </div>
            </div>
          </div>

          <!-- Step 5 Navigation (Final Actions) -->
          <div class="flex justify-between pt-6">
            <button 
              type="button"
              (click)="prevStep()"
              class="px-8 py-3 bg-gray-600 hover:bg-gray-700 text-white font-bold rounded-lg shadow-lg transition-all duration-300 flex items-center gap-2 transform hover:scale-105">
              <i class="pi pi-arrow-left"></i>
              <span>Anterior</span>
            </button>
            <div class="flex gap-4">
              <button 
                type="button"
                (click)="onSave()"
                class="px-8 py-3 bg-yellow-500 hover:bg-yellow-600 text-white font-bold rounded-lg shadow-lg transition-all duration-300 flex items-center gap-2 transform hover:scale-105">
                <i class="pi pi-save"></i>
                <span>Guardar Borrador</span>
              </button>
              <button 
                type="submit"
                [disabled]="postulacionForm.invalid"
                class="px-8 py-3 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-lg transition-all duration-300 flex items-center gap-2 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed">
                <span>Enviar Postulación</span>
                <i class="pi pi-check-circle"></i>
              </button>
            </div>
          </div>
          }

        </div>
      </form>
    </div>
  </div>

