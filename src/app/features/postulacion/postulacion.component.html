<!-- Página de Postulación de Proyecto -->
<div class="min-h-screen bg-surface-100 dark:bg-surface-950 py-8 lg:py-12">
  <div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-7xl">
    <!-- Botón Volver -->
    <div class="mb-6">
      <button 
        pButton 
        type="button"
        label="Volver" 
        icon="pi pi-chevron-left"
        iconPos="left"
        class="rounded-full p-button-outlined p-button-secondary"
        [routerLink]="['/home']">
      </button>
    </div>
    
    <!-- Hero Section -->
    <section class="bg-gradient-to-br from-[#003B8D] to-[#0066CC] text-white rounded-lg shadow-lg mb-8 lg:mb-12 p-6 lg:p-12">
      <h1 class="text-3xl lg:text-4xl xl:text-5xl font-bold mb-4 leading-tight">
        POSTULACIÓN DE PROYECTO
      </h1>
    </section>

    <!-- Formulario de Postulación -->
    <div class="contenido-principal">
      <form [formGroup]="postulacionForm" (ngSubmit)="onSubmit()">
        
        <!-- Acordeón Personalizado con Tailwind -->
        <div class="space-y-4">
          
          <!-- Sección 0: Información Básica -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <button
              type="button"
              (click)="toggleSeccion(0)"
              class="w-full px-6 py-4 flex items-center justify-between bg-white text-black hover:bg-gray-100 transition-all duration-300">
              <div class="flex items-center gap-3">
                <span class="text-2xl font-bold">{{ activeIndex === 0 ? '▼' : '▶' }}</span>
                <span class="text-lg font-semibold">Información Básica</span>
              </div>
              <span class="text-sm bg-gray-300 text-black px-3 py-1">Paso 1</span>
            </button>
            <div class="transition-all duration-300" [class.hidden]="activeIndex !== 0">
              <div class="p-6 space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                  <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Cód. Proyecto</label>
                    <input 
                      type="text"
                      formControlName="cod1"
                      placeholder="Ingrese Cod. Proyecto"
                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
                  </div>
                  <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Proceso Presupuestario <span class="text-red-600">*</span></label>
                    <p-dropdown 
                      formControlName="proceso_presupuestario"
                      [options]="procesoPresupuestarioOptions"
                      optionLabel="label"
                      optionValue="value"
                      placeholder="Seleccione"
                      appendTo="body"
                      class="w-full">
                    </p-dropdown>
                    <small class="text-red-600 text-xs" *ngIf="postulacionForm.get('proceso_presupuestario')?.invalid && postulacionForm.get('proceso_presupuestario')?.touched">
                      Este campo es requerido
                    </small>
                  </div>
                  <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Correo electrónico Formulador <span class="text-red-600">*</span></label>
                    <input 
                      type="email"
                      formControlName="email"
                      placeholder="Ingrese Correo electrónico"
                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
                    <small class="text-red-600 text-xs" *ngIf="postulacionForm.get('email')?.invalid && postulacionForm.get('email')?.touched">
                      <span *ngIf="postulacionForm.get('email')?.errors?.['required']">Este campo es requerido</span>
                      <span *ngIf="postulacionForm.get('email')?.errors?.['email']">Email inválido</span>
                    </small>
                  </div>
                </div>
                
                <!-- Botón Siguiente -->
                <div class="flex justify-end pt-4 border-t border-gray-200">
                  <button 
                    type="button"
                    (click)="siguiente()"
                    class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <span>Siguiente</span>
                    <i class="pi pi-arrow-right"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 1: Nombre de la Iniciativa -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <button
              type="button"
              (click)="toggleSeccion(1)"
              class="w-full px-6 py-4 flex items-center justify-between bg-white text-black hover:bg-gray-100 transition-all duration-300">
              <div class="flex items-center gap-3">
                <span class="text-2xl font-bold">{{ activeIndex === 1 ? '▼' : '▶' }}</span>
                <span class="text-lg font-semibold">NOMBRE DE LA INICIATIVA</span>
              </div>
              <span class="text-sm bg-gray-300 text-black px-3 py-1">Paso 2</span>
            </button>
            <div class="transition-all duration-300" [class.hidden]="activeIndex !== 1">
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <input 
                    type="text"
                    formControlName="item_nombre"
                    placeholder="Ingrese Nombre de la Iniciativa"
                    class="w-full px-4 py-3 text-lg border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
                  <small class="text-red-600 text-xs mt-1 block" *ngIf="postulacionForm.get('item_nombre')?.invalid && postulacionForm.get('item_nombre')?.touched">
                    Este campo es requerido
                  </small>
                  
                  <div class="mt-6">
                    <label class="block text-sm font-semibold text-gray-700 mb-2">DESCRIPTOR</label>
                    <input 
                      type="text"
                      formControlName="item_descriptor"
                      placeholder="Ingrese DESCRIPTOR"
                      readonly
                      class="w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed">
                  </div>
                </div>
                
                <!-- Botones de Navegación -->
                <div class="flex justify-between pt-4 border-t border-gray-200">
                  <button 
                    type="button"
                    (click)="anterior()"
                    class="px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <i class="pi pi-arrow-left"></i>
                    <span>Anterior</span>
                  </button>
                  <button 
                    type="button"
                    (click)="siguiente()"
                    class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <span>Siguiente</span>
                    <i class="pi pi-arrow-right"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 2: Sector/Subsector -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <button
              type="button"
              (click)="toggleSeccion(2)"
              class="w-full px-6 py-4 flex items-center justify-between bg-white text-black hover:bg-gray-100 transition-all duration-300">
              <div class="flex items-center gap-3">
                <span class="text-2xl font-bold">{{ activeIndex === 2 ? '▼' : '▶' }}</span>
                <span class="text-lg font-semibold">SECTOR/SUBSECTOR</span>
              </div>
              <span class="text-sm bg-gray-300 text-black px-3 py-1">Paso 3</span>
            </button>
            <div class="transition-all duration-300" [class.hidden]="activeIndex !== 2">
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                      <label class="block text-sm font-semibold text-gray-700 mb-2">Sector <span class="text-red-600">*</span></label>
                      <input 
                        type="text"
                        formControlName="item_sector"
                        placeholder="INGRESE SECTOR"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
                      <small class="text-red-600 text-xs mt-1 block" *ngIf="postulacionForm.get('item_sector')?.invalid && postulacionForm.get('item_sector')?.touched">
                        Este campo es requerido
                      </small>
                    </div>
                    <div>
                      <label class="block text-sm font-semibold text-gray-700 mb-2">Subsector <span class="text-red-600">*</span></label>
                      <input 
                        type="text"
                        formControlName="item_subsector"
                        placeholder="INGRESE SUBSECTOR"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
                      <small class="text-red-600 text-xs mt-1 block" *ngIf="postulacionForm.get('item_subsector')?.invalid && postulacionForm.get('item_subsector')?.touched">
                        Este campo es requerido
                      </small>
                    </div>
                  </div>
                </div>
                
                <!-- Botones de Navegación -->
                <div class="flex justify-between pt-4 border-t border-gray-200">
                  <button 
                    type="button"
                    (click)="anterior()"
                    class="px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <i class="pi pi-arrow-left"></i>
                    <span>Anterior</span>
                  </button>
                  <button 
                    type="button"
                    (click)="siguiente()"
                    class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <span>Siguiente</span>
                    <i class="pi pi-arrow-right"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 3: Localización Geográfica -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <button
              type="button"
              (click)="toggleSeccion(3)"
              class="w-full px-6 py-4 flex items-center justify-between bg-white text-black hover:bg-gray-100 transition-all duration-300">
              <div class="flex items-center gap-3">
                <span class="text-2xl font-bold">{{ activeIndex === 3 ? '▼' : '▶' }}</span>
                <span class="text-lg font-semibold">LOCALIZACIÓN GEOGRÁFICA</span>
              </div>
              <span class="text-sm bg-gray-300 text-black px-3 py-1">Paso 4</span>
            </button>
            <div class="transition-all duration-300" [class.hidden]="activeIndex !== 3">
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                      <label class="block text-sm font-semibold text-gray-700 mb-2">Provincia <span class="text-red-600">*</span></label>
                      <p-dropdown 
                        formControlName="item_provincia"
                        [options]="provinciaOptions"
                        optionLabel="label"
                        optionValue="value"
                        placeholder="Seleccione Provincia"
                        appendTo="body"
                        class="w-full">
                      </p-dropdown>
                      <small class="text-red-600 text-xs mt-1 block" *ngIf="postulacionForm.get('item_provincia')?.invalid && postulacionForm.get('item_provincia')?.touched">
                        Este campo es requerido
                      </small>
                    </div>
                    <div>
                      <label class="block text-sm font-semibold text-gray-700 mb-2">Comuna <span class="text-red-600">*</span></label>
                      <p-dropdown 
                        formControlName="item_comuna"
                        [options]="comunaOptions"
                        optionLabel="label"
                        optionValue="value"
                        placeholder="Seleccione Comuna"
                        appendTo="body"
                        class="w-full">
                      </p-dropdown>
                      <small class="text-red-600 text-xs mt-1 block" *ngIf="postulacionForm.get('item_comuna')?.invalid && postulacionForm.get('item_comuna')?.touched">
                        Este campo es requerido
                      </small>
                    </div>
                  </div>
                </div>
                
                <!-- Botones de Navegación -->
                <div class="flex justify-between pt-4 border-t border-gray-200">
                  <button 
                    type="button"
                    (click)="anterior()"
                    class="px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <i class="pi pi-arrow-left"></i>
                    <span>Anterior</span>
                  </button>
                  <button 
                    type="button"
                    (click)="siguiente()"
                    class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <span>Siguiente</span>
                    <i class="pi pi-arrow-right"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 4: Competencia de Análisis -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <button
              type="button"
              (click)="toggleSeccion(4)"
              class="w-full px-6 py-4 flex items-center justify-between bg-white text-black hover:bg-gray-100 transition-all duration-300">
              <div class="flex items-center gap-3">
                <span class="text-2xl font-bold">{{ activeIndex === 4 ? '▼' : '▶' }}</span>
                <span class="text-lg font-semibold">COMPETENCIA DE ANÁLISIS</span>
              </div>
              <span class="text-sm bg-gray-300 text-black px-3 py-1">Paso 5</span>
            </button>
            <div class="transition-all duration-300" [class.hidden]="activeIndex !== 4">
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <label class="block text-sm font-semibold text-gray-700 mb-2">Competencia de Análisis <span class="text-red-600">*</span></label>
                  <p-dropdown 
                    formControlName="item_competencia"
                    [options]="competenciaOptions"
                    optionLabel="label"
                    optionValue="value"
                    placeholder="SELECCIONAR COMP. DE ANÁLISIS"
                    appendTo="body"
                    class="w-full">
                  </p-dropdown>
                  <small class="text-red-600 text-xs mt-1 block" *ngIf="postulacionForm.get('item_competencia')?.invalid && postulacionForm.get('item_competencia')?.touched">
                    Este campo es requerido
                  </small>
                </div>
                
                <!-- Botones de Navegación -->
                <div class="flex justify-between pt-4 border-t border-gray-200">
                  <button 
                    type="button"
                    (click)="anterior()"
                    class="px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <i class="pi pi-arrow-left"></i>
                    <span>Anterior</span>
                  </button>
                  <button 
                    type="button"
                    (click)="siguiente()"
                    class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <span>Siguiente</span>
                    <i class="pi pi-arrow-right"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 5: Distrito y Circunscripción -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <button
              type="button"
              (click)="toggleSeccion(5)"
              class="w-full px-6 py-4 flex items-center justify-between bg-white text-black hover:bg-gray-100 transition-all duration-300">
              <div class="flex items-center gap-3">
                <span class="text-2xl font-bold">{{ activeIndex === 5 ? '▼' : '▶' }}</span>
                <span class="text-lg font-semibold">DISTRITO Y CIRCUNSCRIPCIÓN</span>
              </div>
              <span class="text-sm bg-gray-300 text-black px-3 py-1">Paso 6</span>
            </button>
            <div class="transition-all duration-300" [class.hidden]="activeIndex !== 5">
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                      <label class="block text-sm font-semibold text-gray-700 mb-2">DISTRITO</label>
                      <input 
                        type="text"
                        formControlName="item_distrito"
                        placeholder="INGRESE DISTRITO"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
                    </div>
                    <div>
                      <label class="block text-sm font-semibold text-gray-700 mb-2">CIRCUNSCRIPCIÓN</label>
                      <input 
                        type="text"
                        formControlName="item_circunscripcion"
                        placeholder="INGRESE CIRCUNSCRIPCIÓN"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
                    </div>
                  </div>
                </div>
                
                <!-- Botones de Navegación -->
                <div class="flex justify-between pt-4 border-t border-gray-200">
                  <button 
                    type="button"
                    (click)="anterior()"
                    class="px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <i class="pi pi-arrow-left"></i>
                    <span>Anterior</span>
                  </button>
                  <button 
                    type="button"
                    (click)="siguiente()"
                    class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <span>Siguiente</span>
                    <i class="pi pi-arrow-right"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 6: Proyecto Relacionado y SEIA -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <button
              type="button"
              (click)="toggleSeccion(6)"
              class="w-full px-6 py-4 flex items-center justify-between bg-white text-black hover:bg-gray-100 transition-all duration-300">
              <div class="flex items-center gap-3">
                <span class="text-2xl font-bold">{{ activeIndex === 6 ? '▼' : '▶' }}</span>
                <span class="text-lg font-semibold">PROYECTO RELACIONADO Y SEIA</span>
              </div>
              <span class="text-sm bg-gray-300 text-black px-3 py-1">Paso 7</span>
            </button>
            <div class="transition-all duration-300" [class.hidden]="activeIndex !== 6">
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                      <label class="block text-sm font-semibold text-gray-700 mb-2">PROYECTO RELAC.</label>
                      <p-dropdown 
                        formControlName="item_proyectorel"
                        [options]="proyectoRelOptions"
                        optionLabel="label"
                        optionValue="value"
                        placeholder="SELECCIONAR"
                        appendTo="body"
                        class="w-full">
                      </p-dropdown>
                    </div>
                    <div>
                      <label class="block text-sm font-semibold text-gray-700 mb-2">SEIA</label>
                      <p-dropdown 
                        formControlName="item_seia"
                        [options]="seiaOptions"
                        optionLabel="label"
                        optionValue="value"
                        placeholder="NO CORRESPONDE"
                        appendTo="body"
                        class="w-full">
                      </p-dropdown>
                    </div>
                  </div>
                </div>
                
                <!-- Botones de Navegación -->
                <div class="flex justify-between pt-4 border-t border-gray-200">
                  <button 
                    type="button"
                    (click)="anterior()"
                    class="px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <i class="pi pi-arrow-left"></i>
                    <span>Anterior</span>
                  </button>
                  <button 
                    type="button"
                    (click)="siguiente()"
                    class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <span>Siguiente</span>
                    <i class="pi pi-arrow-right"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 7: Justificación del Proyecto -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <button
              type="button"
              (click)="toggleSeccion(7)"
              class="w-full px-6 py-4 flex items-center justify-between bg-white text-black hover:bg-gray-100 transition-all duration-300">
              <div class="flex items-center gap-3">
                <span class="text-2xl font-bold">{{ activeIndex === 7 ? '▼' : '▶' }}</span>
                <span class="text-lg font-semibold">JUSTIFICACIÓN DEL PROYECTO</span>
              </div>
              <span class="text-sm bg-gray-300 text-black px-3 py-1">Paso 8</span>
            </button>
            <div class="transition-all duration-300" [class.hidden]="activeIndex !== 7">
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <label class="block text-sm font-semibold text-gray-700 mb-2">Justificación <span class="text-red-600">*</span></label>
                  <textarea 
                    formControlName="justificacion_proyecto"
                    rows="5"
                    placeholder="Ingrese la justificación del proyecto"
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all resize-none">
                  </textarea>
                  <small class="text-red-600 text-xs mt-1 block" *ngIf="postulacionForm.get('justificacion_proyecto')?.invalid && postulacionForm.get('justificacion_proyecto')?.touched">
                    Este campo es requerido
                  </small>
                </div>
                
                <!-- Botones de Navegación -->
                <div class="flex justify-between pt-4 border-t border-gray-200">
                  <button 
                    type="button"
                    (click)="anterior()"
                    class="px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <i class="pi pi-arrow-left"></i>
                    <span>Anterior</span>
                  </button>
                  <button 
                    type="button"
                    (click)="siguiente()"
                    class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <span>Siguiente</span>
                    <i class="pi pi-arrow-right"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 8: Descripción de la Etapa Programada -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <button
              type="button"
              (click)="toggleSeccion(8)"
              class="w-full px-6 py-4 flex items-center justify-between bg-white text-black hover:bg-gray-100 transition-all duration-300">
              <div class="flex items-center gap-3">
                <span class="text-2xl font-bold">{{ activeIndex === 8 ? '▼' : '▶' }}</span>
                <span class="text-lg font-semibold">DESCRIPCIÓN DE LA ETAPA PROGRAMADA</span>
              </div>
              <span class="text-sm bg-gray-300 text-black px-3 py-1">Paso 9</span>
            </button>
            <div class="transition-all duration-300" [class.hidden]="activeIndex !== 8">
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <label class="block text-sm font-semibold text-gray-700 mb-2">Descripción <span class="text-red-600">*</span></label>
                  <textarea 
                    formControlName="descripcion_proyecto"
                    rows="5"
                    placeholder="Ingrese la descripción de la etapa programada"
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all resize-none">
                  </textarea>
                  <small class="text-red-600 text-xs mt-1 block" *ngIf="postulacionForm.get('descripcion_proyecto')?.invalid && postulacionForm.get('descripcion_proyecto')?.touched">
                    Este campo es requerido
                  </small>
                </div>
                
                <!-- Botones de Navegación -->
                <div class="flex justify-between pt-4 border-t border-gray-200">
                  <button 
                    type="button"
                    (click)="anterior()"
                    class="px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <i class="pi pi-arrow-left"></i>
                    <span>Anterior</span>
                  </button>
                  <button 
                    type="button"
                    (click)="siguiente()"
                    class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <span>Siguiente</span>
                    <i class="pi pi-arrow-right"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 9: Área de Desarrollo Indígena -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <button
              type="button"
              (click)="toggleSeccion(9)"
              class="w-full px-6 py-4 flex items-center justify-between bg-white text-black hover:bg-gray-100 transition-all duration-300">
              <div class="flex items-center gap-3">
                <span class="text-2xl font-bold">{{ activeIndex === 9 ? '▼' : '▶' }}</span>
                <span class="text-lg font-semibold">ÁREA DE DESARROLLO INDÍGENA</span>
              </div>
              <span class="text-sm bg-gray-300 text-black px-3 py-1">Paso 10</span>
            </button>
            <div class="transition-all duration-300" [class.hidden]="activeIndex !== 9">
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <label class="block text-lg font-bold text-gray-800 mb-4">CORRESPONDE A UN ÁREA DE DESARROLLO INDÍGENA <span class="text-red-600">*</span></label>
                  <p-dropdown 
                    formControlName="item_des_indigena"
                    [options]="desIndigenaOptions"
                    optionLabel="label"
                    optionValue="value"
                    placeholder="Seleccionar una opción"
                    appendTo="body"
                    class="w-full md:w-1/3">
                  </p-dropdown>
                  <small class="text-red-600 text-xs mt-1 block" *ngIf="postulacionForm.get('item_des_indigena')?.invalid && postulacionForm.get('item_des_indigena')?.touched">
                    Este campo es requerido
                  </small>
                </div>
                
                <!-- Botones de Navegación -->
                <div class="flex justify-between pt-4 border-t border-gray-200">
                  <button 
                    type="button"
                    (click)="anterior()"
                    class="px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <i class="pi pi-arrow-left"></i>
                    <span>Anterior</span>
                  </button>
                  <button 
                    type="button"
                    (click)="siguiente()"
                    class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <span>Siguiente</span>
                    <i class="pi pi-arrow-right"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 10: Georreferenciación -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <button
              type="button"
              (click)="toggleSeccion(10)"
              class="w-full px-6 py-4 flex items-center justify-between bg-white text-black hover:bg-gray-100 transition-all duration-300">
              <div class="flex items-center gap-3">
                <span class="text-2xl font-bold">{{ activeIndex === 10 ? '▼' : '▶' }}</span>
                <span class="text-lg font-semibold">GEORREFERENCIACIÓN</span>
              </div>
              <span class="text-sm bg-gray-300 text-black px-3 py-1">Paso 11</span>
            </button>
            <div class="transition-all duration-300" [class.hidden]="activeIndex !== 10">
              <div class="p-6 space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
                  <div class="md:col-span-3">
                    <input 
                      type="text"
                      id="addressmap-input"
                      formControlName="addressmap"
                      placeholder="Indique dirección"
                      (keyup.enter)="buscarGeoref()"
                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
                  </div>
                  <div>
                    <button 
                      type="button"
                      (click)="buscarGeoref()"
                      class="w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center justify-center gap-2">
                      <i class="pi pi-search"></i>
                      <span>Buscar</span>
                    </button>
                  </div>
                </div>
                <div id="map" class="w-full rounded-lg border border-gray-300" style="height: 400px;"></div>
                
                <!-- Botones de Navegación -->
                <div class="flex justify-between pt-4 border-t border-gray-200">
                  <button 
                    type="button"
                    (click)="anterior()"
                    class="px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <i class="pi pi-arrow-left"></i>
                    <span>Anterior</span>
                  </button>
                  <button 
                    type="button"
                    (click)="siguiente()"
                    class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <span>Siguiente</span>
                    <i class="pi pi-arrow-right"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 11: Monto solicitado para financiamiento -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <button
              type="button"
              (click)="toggleSeccion(11)"
              class="w-full px-6 py-4 flex items-center justify-between bg-white text-black hover:bg-gray-100 transition-all duration-300">
              <div class="flex items-center gap-3">
                <span class="text-2xl font-bold">{{ activeIndex === 11 ? '▼' : '▶' }}</span>
                <span class="text-lg font-semibold">MONTO SOLICITADO PARA FINANCIAMIENTO</span>
              </div>
              <span class="text-sm bg-gray-300 text-black px-3 py-1">Paso 12</span>
            </button>
            <div class="transition-all duration-300" [class.hidden]="activeIndex !== 11">
              <div class="p-6 space-y-6">
                <div>
                  <p-inputNumber 
                    formControlName="presup1"
                    mode="decimal"
                    [min]="0"
                    [maxFractionDigits]="2"
                    [useGrouping]="true"
                    locale="es-CL"
                    placeholder="Ingrese monto"
                    prefix="$ "
                    styleClass="w-full">
                  </p-inputNumber>
                  <small class="text-red-600 text-xs mt-1 block" *ngIf="postulacionForm.get('presup1')?.invalid && postulacionForm.get('presup1')?.touched">
                    Este campo es requerido
                  </small>
                </div>
                
                <!-- Botones de Navegación -->
                <div class="flex justify-between pt-4 border-t border-gray-200">
                  <button 
                    type="button"
                    (click)="anterior()"
                    class="px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <i class="pi pi-arrow-left"></i>
                    <span>Anterior</span>
                  </button>
                  <button 
                    type="button"
                    (click)="siguiente()"
                    class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <span>Siguiente</span>
                    <i class="pi pi-arrow-right"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 12: Resultado del Análisis Técnico Económico -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <button
              type="button"
              (click)="toggleSeccion(12)"
              class="w-full px-6 py-4 flex items-center justify-between bg-white text-black hover:bg-gray-100 transition-all duration-300">
              <div class="flex items-center gap-3">
                <span class="text-2xl font-bold">{{ activeIndex === 12 ? '▼' : '▶' }}</span>
                <span class="text-lg font-semibold">RESULTADO DEL ANÁLISIS TÉCNICO ECONÓMICO</span>
              </div>
              <span class="text-sm bg-gray-300 text-black px-3 py-1">Paso 13</span>
            </button>
            <div class="transition-all duration-300" [class.hidden]="activeIndex !== 12">
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <label class="block text-sm font-semibold text-gray-700 mb-2">Análisis técnico económico</label>
                  <textarea 
                    formControlName="resultado_analisis_tecnico_economico"
                    rows="6"
                    placeholder="Ingrese el resultado del análisis técnico económico"
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all resize-none">
                  </textarea>
                </div>
                
                <!-- Botones de Navegación -->
                <div class="flex justify-between pt-4 border-t border-gray-200">
                  <button 
                    type="button"
                    (click)="anterior()"
                    class="px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <i class="pi pi-arrow-left"></i>
                    <span>Anterior</span>
                  </button>
                  <button 
                    type="button"
                    (click)="siguiente()"
                    class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <span>Siguiente</span>
                    <i class="pi pi-arrow-right"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 13: Instituciones -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <button
              type="button"
              (click)="toggleSeccion(13)"
              class="w-full px-6 py-4 flex items-center justify-between bg-white text-black hover:bg-gray-100 transition-all duration-300">
              <div class="flex items-center gap-3">
                <span class="text-2xl font-bold">{{ activeIndex === 13 ? '▼' : '▶' }}</span>
                <span class="text-lg font-semibold">INSTITUCIONES QUE PARTICIPAN EN LA EJECUCIÓN DEL PROYECTO</span>
              </div>
              <span class="text-sm bg-gray-300 text-black px-3 py-1">Paso 14</span>
            </button>
            <div class="transition-all duration-300" [class.hidden]="activeIndex !== 13">
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <div class="space-y-4">
                    <div>
                      <label class="block text-sm font-semibold text-gray-700 mb-2">Institución Formuladora de la Etapa</label>
                      <p-dropdown 
                        formControlName="item_insti_formuladora"
                        [options]="institucionesFormuladorasOptions"
                        optionLabel="label"
                        optionValue="value"
                        placeholder="Seleccione"
                        [filter]="shouldFilterInstitucionesFormuladoras"
                        filterPlaceholder="Buscar..."
                        appendTo="body"
                        class="w-full">
                      </p-dropdown>
                    </div>
                    <div>
                      <label class="block text-sm font-semibold text-gray-700 mb-2">Instituciones Financieras</label>
                      <p-dropdown 
                        formControlName="item_insti_financiera"
                        [options]="institucionesFinancierasOptions"
                        optionLabel="label"
                        optionValue="value"
                        placeholder="Seleccione"
                        [filter]="shouldFilterInstitucionesFinancieras"
                        filterPlaceholder="Buscar..."
                        appendTo="body"
                        class="w-full">
                      </p-dropdown>
                    </div>
                    <div>
                      <label class="block text-sm font-semibold text-gray-700 mb-2">Instituciones Técnicas</label>
                      <p-dropdown 
                        formControlName="institucion_tecnica_a_cargo"
                        [options]="institucionesTecnicasOptions"
                        optionLabel="label"
                        optionValue="value"
                        placeholder="Seleccione"
                        [filter]="shouldFilterInstitucionesTecnicas"
                        filterPlaceholder="Buscar..."
                        appendTo="body"
                        class="w-full">
                      </p-dropdown>
                    </div>
                  </div>
                </div>
                
                <!-- Botones de Navegación -->
                <div class="flex justify-between pt-4 border-t border-gray-200">
                  <button 
                    type="button"
                    (click)="anterior()"
                    class="px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <i class="pi pi-arrow-left"></i>
                    <span>Anterior</span>
                  </button>
                  <button 
                    type="button"
                    (click)="siguiente()"
                    class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <span>Siguiente</span>
                    <i class="pi pi-arrow-right"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 14: Resumen de los Resultados del Proyecto -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <button
              type="button"
              (click)="toggleSeccion(14)"
              class="w-full px-6 py-4 flex items-center justify-between bg-white text-black hover:bg-gray-100 transition-all duration-300">
              <div class="flex items-center gap-3">
                <span class="text-2xl font-bold">{{ activeIndex === 14 ? '▼' : '▶' }}</span>
                <span class="text-lg font-semibold">RESUMEN DE LOS RESULTADOS DEL PROYECTO</span>
              </div>
              <span class="text-sm bg-gray-300 text-black px-3 py-1">Paso 15</span>
            </button>
            <div class="transition-all duration-300" [class.hidden]="activeIndex !== 14">
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <!-- Duración -->
                  <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                    <div class="bg-blue-200 p-3 rounded-lg">
                      <label class="block text-sm font-semibold text-gray-800">Duración</label>
                    </div>
                    <div class="md:col-span-2 flex items-center gap-4">
                      <p-inputNumber 
                        formControlName="duracion_proyecto"
                        mode="decimal"
                        [min]="0"
                        class="w-32">
                      </p-inputNumber>
                      <span class="text-sm font-semibold text-gray-700">Meses</span>
                    </div>
                  </div>

                  <!-- Beneficiarios Directos -->
                  <div class="mb-4">
                    <div class="bg-blue-200 p-3 rounded-lg mb-2">
                      <label class="block text-sm font-semibold text-gray-800">Beneficiarios Directos</label>
                    </div>
                    <div class="space-y-2">
                      <div class="flex items-center gap-4">
                        <label class="text-sm font-semibold text-gray-700 w-32">Hombres:</label>
                        <p-inputNumber 
                          formControlName="benef_hombres"
                          mode="decimal"
                          [min]="0"
                          class="flex-1">
                        </p-inputNumber>
                      </div>
                      <div class="flex items-center gap-4">
                        <label class="text-sm font-semibold text-gray-700 w-32">Mujeres:</label>
                        <p-inputNumber 
                          formControlName="benef_mujeres"
                          mode="decimal"
                          [min]="0"
                          class="flex-1">
                        </p-inputNumber>
                      </div>
                      <div class="flex items-center gap-4">
                        <label class="text-sm font-semibold text-gray-700 w-32">Total:</label>
                        <p-inputNumber 
                          formControlName="benef_total"
                          mode="decimal"
                          [min]="0"
                          class="flex-1"
                          [readonly]="true">
                        </p-inputNumber>
                      </div>
                    </div>
                  </div>

                  <!-- Magnitud del Proyecto -->
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                      <label class="block text-sm font-semibold text-gray-700 mb-2">MAGNITUD</label>
                      <input 
                        type="text"
                        formControlName="item_magnitud_valor"
                        placeholder="Ingrese MAGNITUD"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
                    </div>
                    <div>
                      <label class="block text-sm font-semibold text-gray-700 mb-2">UNIDAD MEDIDA</label>
                      <p-dropdown 
                        formControlName="item_magnitud"
                        [options]="magnitudOptions"
                        optionLabel="label"
                        optionValue="value"
                        placeholder="Definir Unidad Medida"
                        [filter]="shouldFilterMagnitud"
                        filterPlaceholder="Buscar..."
                        appendTo="body"
                        class="w-full">
                      </p-dropdown>
                    </div>
                  </div>
                </div>
                
                <!-- Botones de Navegación -->
                <div class="flex justify-between pt-4 border-t border-gray-200">
                  <button 
                    type="button"
                    (click)="anterior()"
                    class="px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <i class="pi pi-arrow-left"></i>
                    <span>Anterior</span>
                  </button>
                  <button 
                    type="button"
                    (click)="siguiente()"
                    class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <span>Siguiente</span>
                    <i class="pi pi-arrow-right"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 15: Información de Contacto -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <button
              type="button"
              (click)="toggleSeccion(15)"
              class="w-full px-6 py-4 flex items-center justify-between bg-white text-black hover:bg-gray-100 transition-all duration-300">
              <div class="flex items-center gap-3">
                <span class="text-2xl font-bold">{{ activeIndex === 15 ? '▼' : '▶' }}</span>
                <span class="text-lg font-semibold">INFORMACIÓN DE CONTACTO</span>
              </div>
              <span class="text-sm bg-gray-300 text-black px-3 py-1">Paso 16</span>
            </button>
            <div class="transition-all duration-300" [class.hidden]="activeIndex !== 15">
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <label class="block text-lg font-bold text-gray-800 mb-4">INFORMACIÓN ADICIONAL</label>
                  
                  <!-- Información de Contacto -->
                  <div class="mb-6">
                    <h4 class="text-sm font-semibold text-gray-700 mb-3">Información de Contacto</h4>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                      <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Nombre Responsable / Encargado Iniciativa <span class="text-red-600">*</span></label>
                        <input 
                          type="text"
                          formControlName="nombre_responsable"
                          placeholder="Ingrese nombre"
                          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
                        <small class="text-red-600 text-xs mt-1 block" *ngIf="postulacionForm.get('nombre_responsable')?.invalid && postulacionForm.get('nombre_responsable')?.touched">
                          Este campo es requerido
                        </small>
                      </div>
                      <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Correo electrónico <span class="text-red-600">*</span></label>
                        <input 
                          type="email"
                          formControlName="responsable_email"
                          placeholder="Ingrese correo electrónico"
                          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
                        <small class="text-red-600 text-xs mt-1 block" *ngIf="postulacionForm.get('responsable_email')?.invalid && postulacionForm.get('responsable_email')?.touched">
                          <span *ngIf="postulacionForm.get('responsable_email')?.errors?.['required']">Este campo es requerido</span>
                          <span *ngIf="postulacionForm.get('responsable_email')?.errors?.['email']">Email inválido</span>
                        </small>
                      </div>
                      <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Teléfono <span class="text-red-600">*</span></label>
                        <input 
                          type="text"
                          formControlName="responsable_fono"
                          placeholder="Ingrese número directo o celular"
                          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
                        <small class="text-red-600 text-xs mt-1 block" *ngIf="postulacionForm.get('responsable_fono')?.invalid && postulacionForm.get('responsable_fono')?.touched">
                          Este campo es requerido
                        </small>
                      </div>
                    </div>
                  </div>

                  <!-- Información del Ordinario u Oficio Conductor -->
                  <div class="mb-6">
                    <h4 class="text-sm font-semibold text-gray-700 mb-3">Información del Ordinario u Oficio Conductor</h4>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                      <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Núm. Ordinal</label>
                        <input 
                          type="text"
                          formControlName="num_ordinal"
                          placeholder="Ingrese Núm. Ordinal"
                          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
                      </div>
                      <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Fecha</label>
                        <p-calendar 
                          formControlName="ordinal_fecha"
                          dateFormat="dd-mm-yy"
                          placeholder="dd-mm-aaaa"
                          [showIcon]="true"
                          appendTo="body"
                          class="w-full">
                        </p-calendar>
                      </div>
                      <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Remite</label>
                        <p-dropdown 
                          formControlName="remitente"
                          [options]="remitenteOptions"
                          optionLabel="label"
                          optionValue="value"
                          placeholder="Seleccione"
                          appendTo="body"
                          class="w-full">
                        </p-dropdown>
                      </div>
                      <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Comuna</label>
                        <p-dropdown 
                          formControlName="remite_comuna"
                          [options]="comunaOptions"
                          optionLabel="label"
                          optionValue="value"
                          placeholder="Seleccione Comuna"
                          [filter]="shouldFilterComunas"
                          filterPlaceholder="Buscar..."
                          appendTo="body"
                          class="w-full">
                        </p-dropdown>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- Botones de Navegación -->
                <div class="flex justify-between pt-4 border-t border-gray-200">
                  <button 
                    type="button"
                    (click)="anterior()"
                    class="px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <i class="pi pi-arrow-left"></i>
                    <span>Anterior</span>
                  </button>
                  <button 
                    type="button"
                    (click)="siguiente()"
                    class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <span>Siguiente</span>
                    <i class="pi pi-arrow-right"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 16: Adjuntos Requeridos -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <button
              type="button"
              (click)="toggleSeccion(16)"
              class="w-full px-6 py-4 flex items-center justify-between bg-white text-black hover:bg-gray-100 transition-all duration-300">
              <div class="flex items-center gap-3">
                <span class="text-2xl font-bold">{{ activeIndex === 16 ? '▼' : '▶' }}</span>
                <span class="text-lg font-semibold">ADJUNTOS REQUERIDOS</span>
              </div>
              <span class="text-sm bg-gray-300 text-black px-3 py-1">Paso 17</span>
            </button>
            <div class="transition-all duration-300" [class.hidden]="activeIndex !== 16">
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <div class="flex justify-between items-center mb-4">
                    <h4 class="text-sm font-semibold text-gray-700">Adjuntos Requeridos</h4>
                    <button 
                      type="button"
                      (click)="abrirDialogDocumento()"
                      class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white text-sm font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                      <i class="pi pi-plus"></i>
                      <span>Agregar Documento</span>
                    </button>
                  </div>
                  
                  <!-- Lista de Documentos -->
                  <div class="mt-4" *ngIf="documentosAdjuntos.length > 0">
                    <div class="overflow-x-auto">
                      <table class="min-w-full divide-y divide-gray-200 border border-gray-300 rounded-lg">
                        <thead class="bg-gray-100">
                          <tr>
                            <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase">Nombre del Documento</th>
                            <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase">Archivo</th>
                            <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase">Tamaño</th>
                            <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase">Fecha</th>
                            <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase">Acciones</th>
                          </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                          <tr *ngFor="let documento of documentosAdjuntos" class="hover:bg-gray-50">
                            <td class="px-4 py-3 text-sm text-gray-900">{{ documento.nombre }}</td>
                            <td class="px-4 py-3 text-sm text-gray-600">{{ documento.nombreArchivo }}</td>
                            <td class="px-4 py-3 text-sm text-gray-600">{{ documento.archivo ? formatearTamano(documento.archivo.size) : '-' }}</td>
                            <td class="px-4 py-3 text-sm text-gray-600">{{ documento.fechaSubida | date:'dd-MM-yyyy HH:mm' }}</td>
                            <td class="px-4 py-3 text-sm">
                              <button 
                                type="button"
                                (click)="editarDocumento(documento)"
                                class="px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white rounded mr-2 transition-all duration-300">
                                <i class="pi pi-pencil"></i>
                              </button>
                              <button 
                                type="button"
                                (click)="eliminarDocumento(documento.id)"
                                class="px-3 py-1 bg-red-500 hover:bg-red-600 text-white rounded transition-all duration-300">
                                <i class="pi pi-trash"></i>
                              </button>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                  
                  <div *ngIf="documentosAdjuntos.length === 0" class="text-gray-600 mt-4 p-4 bg-gray-50 rounded-lg border border-gray-200">
                    <p class="text-center">No hay documentos adjuntos. Haga clic en "Agregar Documento" para agregar uno.</p>
                    <p class="text-xs text-center mt-2 text-gray-500">Tamaño máximo recomendado por archivo: 4MB</p>
                  </div>
                </div>
                
                <!-- Botones de Navegación -->
                <div class="flex justify-between pt-4 border-t border-gray-200">
                  <button 
                    type="button"
                    (click)="anterior()"
                    class="px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <i class="pi pi-arrow-left"></i>
                    <span>Anterior</span>
                  </button>
                  <button 
                    type="button"
                    (click)="siguiente()"
                    class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <span>Siguiente</span>
                    <i class="pi pi-arrow-right"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Sección 17: Resumen y Envío -->
          <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
            <button
              type="button"
              (click)="toggleSeccion(17)"
              class="w-full px-6 py-4 flex items-center justify-between bg-white text-black hover:bg-gray-100 transition-all duration-300">
              <div class="flex items-center gap-3">
                <span class="text-2xl font-bold">{{ activeIndex === 17 ? '▼' : '▶' }}</span>
                <span class="text-lg font-semibold">RESUMEN Y ENVÍO</span>
              </div>
            </button>
            <div class="transition-all duration-300" [class.hidden]="activeIndex !== 17">
              <div class="p-6 space-y-6">
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                  <h3 class="text-lg font-semibold text-gray-800 mb-4">Revise la información antes de enviar la postulación</h3>
                  <p class="text-gray-600 mb-6">Asegúrese de que todos los campos requeridos estén completos.</p>
                </div>
                
                <!-- Botones de Acción Final -->
                <div class="flex justify-between pt-4 border-t border-gray-200">
                  <button 
                    type="button"
                    (click)="anterior()"
                    class="px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                    <i class="pi pi-arrow-left"></i>
                    <span>Anterior</span>
                  </button>
                  <div class="flex gap-4">
                    <button 
                      type="button"
                      (click)="onSave()"
                      class="px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                      <i class="pi pi-save"></i>
                      <span>Guardar Borrador</span>
                    </button>
                    <button 
                      type="submit"
                      class="px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-semibold rounded-lg shadow-md transition-all duration-300 flex items-center gap-2">
                      <span>Enviar Postulación</span>
                      <i class="pi pi-send"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>
      </form>
    </div>
  </div>
</div>

<!-- Dialog para Agregar/Editar Documento -->
<p-dialog 
  [(visible)]="mostrarDialogDocumento" 
  [header]="esEdicionDocumento() ? 'Editar Documento' : 'Agregar Documento'"
  [modal]="true"
  [style]="{width: '600px'}"
  [draggable]="false"
  [resizable]="false">
  <div class="space-y-4">
    <div>
      <label class="block text-sm font-semibold text-gray-700 mb-2">Nombre del Documento <span class="text-red-600">*</span></label>
      <input 
        type="text"
        [(ngModel)]="documentoSeleccionado.nombre"
        placeholder="Ingrese nombre del documento"
        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"
        *ngIf="documentoSeleccionado">
      <small class="text-gray-500 text-xs block mt-1">Ingrese un nombre descriptivo para identificar el documento</small>
    </div>
    
    <div>
      <label class="block text-sm font-semibold text-gray-700 mb-2">Seleccionar Archivo <span class="text-red-600">*</span></label>
      <input 
        type="file"
        (change)="onFileSelect($event)"
        accept=".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png"
        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
      <small class="text-gray-500 text-xs block mt-1">
        Formatos aceptados: PDF, DOC, DOCX, XLS, XLSX, JPG, JPEG, PNG. Tamaño máximo: 4MB
      </small>
      <div *ngIf="documentoSeleccionado && documentoSeleccionado.nombreArchivo" class="mt-2 p-3 bg-blue-50 rounded-lg border border-blue-200">
        <p class="text-sm text-blue-800">
          <i class="pi pi-file mr-2"></i>
          Archivo seleccionado: <strong>{{ documentoSeleccionado.nombreArchivo }}</strong>
          <span *ngIf="documentoSeleccionado.archivo" class="ml-2">
            ({{ formatearTamano(documentoSeleccionado.archivo.size) }})
          </span>
        </p>
      </div>
    </div>
  </div>
  
  <ng-template pTemplate="footer">
    <button 
      type="button"
      (click)="cerrarDialogDocumento()"
      class="px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold rounded-lg transition-all duration-300">
      Cancelar
    </button>
    <button 
      type="button"
      (click)="esEdicionDocumento() ? actualizarDocumento() : guardarDocumento()"
      class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-all duration-300">
      {{ esEdicionDocumento() ? 'Actualizar' : 'Guardar' }}
    </button>
  </ng-template>
</p-dialog>
